-- Copyright (c) 2016-present, Facebook, Inc.
-- All rights reserved.
--
-- This source code is licensed under the BSD-style license found in the
-- LICENSE file in the root directory of this source tree. An additional grant
-- of patent rights can be found in the PATENTS file in the same directory.

module Duckling.Time.Computed
  ( chineseNewYear, easterSunday, orthodoxEaster
  ) where

import Data.Maybe
import Prelude
import qualified Data.Time as Time

import Duckling.Time.Helpers (timeComputed)
import Duckling.Time.Types (TimeData(..), TimeObject(..), timedata')
import qualified Duckling.TimeGrain.Types as TG

toTimeObjectM :: (Integer, Int, Int) -> Maybe TimeObject
toTimeObjectM (year, month, day) = do
  day <- Time.fromGregorianValid year month day
  let start = Time.UTCTime day 0
  return TimeObject
    { start = start
    , grain = TG.Day
    , end = Nothing
    }

computedDays :: [TimeObject] -> TimeData
computedDays xs = timedata'
  { timePred = timeComputed xs
  , timeGrain = TG.Day
  }

chineseNewYear :: TimeData
chineseNewYear = computedDays chineseNewYear'

chineseNewYear' :: [TimeObject]
chineseNewYear' = mapMaybe toTimeObjectM
  [ (1950, 2, 17)
  , (1951, 2, 6)
  , (1952, 1, 27)
  , (1953, 2, 14)
  , (1954, 2, 3)
  , (1955, 1, 24)
  , (1956, 2, 12)
  , (1957, 1, 31)
  , (1958, 2, 18)
  , (1959, 2, 8)
  , (1960, 1, 28)
  , (1961, 2, 15)
  , (1962, 2, 5)
  , (1963, 1, 25)
  , (1964, 2, 13)
  , (1965, 2, 2)
  , (1966, 1, 21)
  , (1967, 2, 9)
  , (1968, 1, 30)
  , (1969, 2, 17)
  , (1970, 2, 6)
  , (1971, 1, 27)
  , (1972, 2, 15)
  , (1973, 2, 3)
  , (1974, 1, 23)
  , (1975, 2, 11)
  , (1976, 1, 31)
  , (1977, 2, 18)
  , (1978, 2, 7)
  , (1979, 1, 28)
  , (1980, 2, 16)
  , (1981, 2, 5)
  , (1982, 1, 25)
  , (1983, 2, 13)
  , (1984, 2, 2)
  , (1985, 2, 20)
  , (1986, 2, 9)
  , (1987, 1, 29)
  , (1988, 2, 17)
  , (1989, 2, 6)
  , (1990, 1, 27)
  , (1991, 2, 15)
  , (1992, 2, 4)
  , (1993, 1, 23)
  , (1994, 2, 10)
  , (1995, 1, 31)
  , (1996, 2, 19)
  , (1997, 2, 7)
  , (1998, 1, 28)
  , (1999, 2, 16)
  , (2000, 2, 5)
  , (2001, 1, 24)
  , (2002, 2, 12)
  , (2003, 2, 1)
  , (2004, 1, 22)
  , (2005, 2, 9)
  , (2006, 1, 29)
  , (2007, 2, 18)
  , (2008, 2, 7)
  , (2009, 1, 26)
  , (2010, 2, 14)
  , (2011, 2, 3)
  , (2012, 1, 23)
  , (2013, 2, 10)
  , (2014, 1, 31)
  , (2015, 2, 19)
  , (2016, 2, 8)
  , (2017, 1, 28)
  , (2018, 2, 16)
  , (2019, 2, 5)
  , (2020, 1, 25)
  , (2021, 2, 12)
  , (2022, 2, 1)
  , (2023, 1, 22)
  , (2024, 2, 10)
  , (2025, 1, 29)
  , (2026, 2, 17)
  , (2027, 2, 6)
  , (2028, 1, 26)
  , (2029, 2, 13)
  , (2030, 2, 3)
  , (2031, 1, 23)
  , (2032, 2, 11)
  , (2033, 1, 31)
  , (2034, 2, 19)
  , (2035, 2, 8)
  , (2036, 1, 28)
  , (2037, 2, 15)
  , (2038, 2, 4)
  , (2039, 1, 24)
  , (2040, 2, 12)
  , (2041, 2, 1)
  , (2042, 1, 22)
  , (2043, 2, 10)
  , (2044, 1, 30)
  , (2045, 2, 17)
  , (2046, 2, 6)
  , (2047, 1, 26)
  , (2048, 2, 14)
  , (2049, 2, 2)
  , (2050, 1, 23)
  ]

easterSunday :: TimeData
easterSunday = computedDays easterSunday'

easterSunday' :: [TimeObject]
easterSunday' = mapMaybe toTimeObjectM
  [ (1950, 4, 9)
  , (1951, 3, 25)
  , (1952, 4, 13)
  , (1953, 4, 5)
  , (1954, 4, 18)
  , (1955, 4, 10)
  , (1956, 4, 1)
  , (1957, 4, 21)
  , (1958, 4, 6)
  , (1959, 3, 29)
  , (1960, 4, 17)
  , (1961, 4, 2)
  , (1962, 4, 22)
  , (1963, 4, 14)
  , (1964, 3, 29)
  , (1965, 4, 18)
  , (1966, 4, 10)
  , (1967, 3, 26)
  , (1968, 4, 14)
  , (1969, 4, 6)
  , (1970, 3, 29)
  , (1971, 4, 11)
  , (1972, 4, 2)
  , (1973, 4, 22)
  , (1974, 4, 14)
  , (1975, 3, 30)
  , (1976, 4, 18)
  , (1977, 4, 10)
  , (1978, 3, 26)
  , (1979, 4, 15)
  , (1980, 4, 6)
  , (1981, 4, 19)
  , (1982, 4, 11)
  , (1983, 4, 3)
  , (1984, 4, 22)
  , (1985, 4, 7)
  , (1986, 3, 30)
  , (1987, 4, 19)
  , (1988, 4, 3)
  , (1989, 3, 26)
  , (1990, 4, 15)
  , (1991, 3, 31)
  , (1992, 4, 19)
  , (1993, 4, 11)
  , (1994, 4, 3)
  , (1995, 4, 16)
  , (1996, 4, 7)
  , (1997, 3, 30)
  , (1998, 4, 12)
  , (1999, 4, 4)
  , (2000, 4, 23)
  , (2001, 4, 15)
  , (2002, 3, 31)
  , (2003, 4, 20)
  , (2004, 4, 11)
  , (2005, 3, 27)
  , (2006, 4, 16)
  , (2007, 4, 8)
  , (2008, 3, 23)
  , (2009, 4, 12)
  , (2010, 4, 4)
  , (2011, 4, 24)
  , (2012, 4, 8)
  , (2013, 3, 31)
  , (2014, 4, 20)
  , (2015, 4, 5)
  , (2016, 3, 27)
  , (2017, 4, 16)
  , (2018, 4, 1)
  , (2019, 4, 21)
  , (2020, 4, 12)
  , (2021, 4, 4)
  , (2022, 4, 17)
  , (2023, 4, 9)
  , (2024, 3, 31)
  , (2025, 4, 20)
  , (2026, 4, 5)
  , (2027, 3, 28)
  , (2028, 4, 16)
  , (2029, 4, 1)
  , (2030, 4, 21)
  , (2031, 4, 13)
  , (2032, 3, 28)
  , (2033, 4, 17)
  , (2034, 4, 9)
  , (2035, 3, 25)
  , (2036, 4, 13)
  , (2037, 4, 5)
  , (2038, 4, 25)
  , (2039, 4, 10)
  , (2040, 4, 1)
  , (2041, 4, 21)
  , (2042, 4, 6)
  , (2043, 3, 29)
  , (2044, 4, 17)
  , (2045, 4, 9)
  , (2046, 3, 25)
  , (2047, 4, 14)
  , (2048, 4, 5)
  , (2049, 4, 18)
  , (2050, 4, 10)
  ]

orthodoxEaster :: TimeData
orthodoxEaster = computedDays orthodoxEaster'

orthodoxEaster' :: [TimeObject]
orthodoxEaster' = mapMaybe toTimeObjectM
  [ (1950, 4, 9)
  , (1951, 4, 29)
  , (1952, 4, 20)
  , (1953, 4, 5)
  , (1954, 4, 25)
  , (1955, 4, 17)
  , (1956, 5, 6)
  , (1957, 4, 21)
  , (1958, 4, 13)
  , (1959, 5, 3)
  , (1960, 4, 17)
  , (1961, 4, 9)
  , (1962, 4, 29)
  , (1963, 4, 14)
  , (1964, 5, 3)
  , (1965, 4, 25)
  , (1966, 4, 10)
  , (1967, 4, 30)
  , (1968, 4, 21)
  , (1969, 4, 13)
  , (1970, 4, 26)
  , (1971, 4, 18)
  , (1972, 4, 9)
  , (1973, 4, 29)
  , (1974, 4, 14)
  , (1975, 5, 4)
  , (1976, 4, 25)
  , (1977, 4, 10)
  , (1978, 4, 30)
  , (1979, 4, 22)
  , (1980, 4, 6)
  , (1981, 4, 26)
  , (1982, 4, 18)
  , (1983, 5, 8)
  , (1984, 4, 22)
  , (1985, 4, 14)
  , (1986, 5, 4)
  , (1987, 4, 19)
  , (1988, 4, 10)
  , (1989, 4, 30)
  , (1990, 4, 15)
  , (1991, 4, 7)
  , (1992, 4, 26)
  , (1993, 4, 18)
  , (1994, 5, 1)
  , (1995, 4, 23)
  , (1996, 4, 14)
  , (1997, 4, 27)
  , (1998, 4, 19)
  , (1999, 4, 11)
  , (2000, 4, 30)
  , (2001, 4, 15)
  , (2002, 5, 5)
  , (2003, 4, 27)
  , (2004, 4, 11)
  , (2005, 5, 1)
  , (2006, 4, 23)
  , (2007, 4, 8)
  , (2008, 4, 27)
  , (2009, 4, 19)
  , (2010, 4, 4)
  , (2011, 4, 24)
  , (2012, 4, 15)
  , (2013, 5, 5)
  , (2014, 4, 20)
  , (2015, 4, 12)
  , (2016, 5, 1)
  , (2017, 4, 16)
  , (2018, 4, 8)
  , (2019, 4, 28)
  , (2020, 4, 19)
  , (2021, 5, 2)
  , (2022, 4, 24)
  , (2023, 4, 16)
  , (2024, 5, 5)
  , (2025, 4, 20)
  , (2026, 4, 12)
  , (2027, 5, 2)
  , (2028, 4, 16)
  , (2029, 4, 8)
  , (2030, 4, 28)
  , (2031, 4, 13)
  , (2032, 5, 2)
  , (2033, 4, 24)
  , (2034, 4, 9)
  , (2035, 4, 29)
  , (2036, 4, 20)
  , (2037, 4, 5)
  , (2038, 4, 25)
  , (2039, 4, 17)
  , (2040, 5, 6)
  , (2041, 4, 21)
  , (2042, 4, 13)
  , (2043, 5, 3)
  , (2044, 4, 24)
  , (2045, 4, 9)
  , (2046, 4, 29)
  , (2047, 4, 21)
  , (2048, 4, 5)
  , (2049, 4, 25)
  , (2050, 4, 17)
  ]
